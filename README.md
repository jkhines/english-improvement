# english-improvement
A Chrome plugin to transform English websites into ones implementing suggested spelling and language reforms.

## Features

- **Spelling Reform Mode**: Applies simplified spelling rules (thru, tho, tuff, etc.)
- **Anglish Mode**: Translates text to use Germanic-rooted English words

## Project Structure

```
english-improvement/
├── src/                      # TypeScript source files
│   ├── content.ts           # Main content script (spelling reform & Anglish translation)
│   ├── popup.ts             # Extension popup UI logic
│   └── types.d.ts           # Type declarations for external JS files
│
├── dist/                     # Compiled JavaScript (generated by `npm run build`)
│   ├── content.js           # Compiled content script
│   ├── popup.js             # Compiled popup script
│   ├── wordbook.js          # Copied from root (Anglish wordbook)
│   └── grammar_engine.js    # Copied from root (grammar transformations)
│
├── wordbook.js               # Anglish wordbook (MPL-2.0, external dependency)
├── grammar_engine.js         # Grammar engine (MPL-2.0, external dependency)
│
├── manifest.json             # Chrome extension manifest
├── popup.html                # Extension popup UI
├── popup.css                 # Extension popup styles
│
├── test.js                   # Jest test suite
├── test.html                 # Manual testing page
├── tests.html                # Browser-based visual test suite
│
├── tsconfig.json             # TypeScript configuration
├── jest.config.js            # Jest configuration
├── package.json              # NPM dependencies and scripts
│
└── icons/                    # Extension icons (16px, 48px, 128px)
    ├── icon16.png
    ├── icon48.png
    ├── icon128.png
    └── *_inverted.png        # Inverted versions for enabled state
```

### Key Files

- **`src/content.ts`**: Core logic for applying spelling reforms and Anglish translations to web pages
- **`src/popup.ts`**: Handles extension popup UI, mode selection, and enabling/disabling the extension
- **`wordbook.js`**: Large dictionary mapping English words/phrases to Anglish equivalents (from Anglish Translator project)
- **`grammar_engine.js`**: Functions for grammatical transformations (pluralization, verb tenses) (from Anglish Translator project)
- **`manifest.json`**: Chrome extension configuration, permissions, and content script declarations

## Development

This project uses TypeScript. Source files are in `src/` and compiled JavaScript is output to `dist/`.

### Building

```powershell
npm run build        # Compile TypeScript to JavaScript
npm run watch        # Watch mode for development
```

### Installation

1. Build the project: `npm run build`
2. Open Chrome and navigate to `chrome://extensions/`
3. Enable "Developer mode" (toggle in top right)
4. Click "Load unpacked"
5. Select the `english-improvement` directory
6. **Important**: After making any changes to the code:
   - Run `npm run build` to recompile
   - Click the refresh icon on the extension card in Chrome

## Testing

### Browser-based Tests (Visual)
Open `tests.html` in your browser to run the interactive test suite with visual feedback:
```
file:///path/to/english-improvement/tests.html
```

Features:
- Visual test results with pass/fail indicators
- Test summary dashboard
- Organized by test suites
- Auto-runs on page load

### Command-line Tests (Automated)
Run the Jest test suite for automated testing:
```powershell
npm test
```

Additional Jest commands:
```powershell
npm run test:watch    # Run tests in watch mode
npm run test:coverage # Generate coverage report
```

The test suite uses Jest and includes:
- Unit tests for translation functions
- Grammar engine tests
- DOM integration tests
- Edge case handling

### End-to-End Tests (E2E)
Run Playwright end-to-end tests that load the extension and verify transformations on a test HTML page:

```powershell
npm run test:e2e
```

Additional E2E commands:
```powershell
npm run test:e2e:ui      # Run tests with Playwright UI mode
npm run test:e2e:headed   # Run tests in headed mode (visible browser)
npm run test:e2e:debug    # Run tests in debug mode
```

**Prerequisites:**
1. Build the extension: `npm run build`
2. Start a local HTTP server in the project root: `npx http-server . -p 8080 -c-1`
3. Run the E2E tests in another terminal: `npm run test:e2e`

The E2E tests verify:
- Extension popup loads correctly
- Spelling reform transformations work on page content
- Anglish translations work on page content
- Transformations work inside links without breaking href attributes
- Reverting transformations restores original text
- Code, pre, and textarea elements are skipped
- Mode switching works correctly

### Manual Testing
Open `test.html` in Chrome to see example transformations on a live page.

## Troubleshooting

### Extension not working after code changes:
1. Go to `chrome://extensions/`
2. Find "English Improvement"
3. Click the refresh/reload icon
4. Reload the test page

### Checking for errors:
1. Open the test page
2. Press F12 to open Developer Tools
3. Go to the Console tab
4. Look for messages starting with "English Improvement:"
5. You should see:
   - "Wordbook loaded successfully with XXXX entries"
   - "Received message applyAnglish" (when clicking Enable)
   - "Applied Anglish translation"

### Common issues:
- **No transformation**: Make sure you clicked "Enable" after selecting a mode
- **Console errors about wordbook**: The extension needs to be reloaded
- **"Cannot read property" errors**: Reload the extension and refresh the page

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

**Note**: This project includes components from the [Anglish Translator](https://github.com/Bark-fa/Anglish-Translator) project, which are licensed under the Mozilla Public License 2.0 (MPL-2.0). See the [NOTICE](NOTICE) file for details on third-party software.
